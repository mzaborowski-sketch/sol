<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cron na QNAP (BusyBox) â€” peÅ‚na Å›ciÄ…ga z przykÅ‚adami</title>
  <meta name="theme-color" content="#111827" />
  <link rel="stylesheet" href="assets/css/metro.css" />
  <style>
    body.accent-black { --accent:#111827; }
    body.accent-black .floating-menu a { background:#111827; }
    code,kbd { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; }
    .kbd { background:#11182708; border:1px solid #11182722; border-radius:6px; padding:.05em .35em; }
    .muted { opacity:.75; }
    .note { background:#11182708; border-left:4px solid var(--accent); padding:.6rem .9rem; border-radius:.25rem; }
    .ex-grid { display:grid; grid-template-columns: 1fr; gap: .75rem; }
    @media (min-width: 900px){ .ex-grid { grid-template-columns: 1fr 1fr; } }
    .card { border:1px solid #11182722; border-radius: .75rem; padding: .9rem 1rem; background:white; }
    .ok { color: #065f46; }
    .bad { color: #991b1b; }
    .table th, .table td { white-space: nowrap; }
  </style>
</head>
<body class="accent-black has-floating">
<main class="container tight">

  <!-- MENU -->
  <div class="floating-menu">
    <a href="index.html" title="PowrÃ³t do menu">
      <span class="label">MENU</span>
      <span class="emoji">ğŸ </span>
    </a>
  </div>

  <section class="hero">
    <div class="kicker">QNAP â€¢ BusyBox crond</div>
    <h1>Cron â€” jak czytaÄ‡ i pisaÄ‡ harmonogramy (ze szczegÃ³lnym naciskiem na <code>*</code>)</h1>
    <p>Ta strona tÅ‚umaczy dokÅ‚adnie <strong>gwiazdki</strong>, operatory <code>, - /</code>, kolejnoÅ›Ä‡ pÃ³l, logikÄ™
       <em>DOM vs DOW</em> oraz zawiera gotowe przykÅ‚ady (w tym â€2:30 pmâ€).</p>
  </section>

  <section class="content">
    <h2>0) Gdzie edytowaÄ‡ crona na QNAP-ie?</h2>
    <p>Plik: <code>/etc/config/crontab</code>. Po edycji <em>zaÅ‚aduj i zrestartuj</em> usÅ‚ugÄ™:</p>
<pre><code>crontab /etc/config/crontab
/etc/init.d/crond.sh restart || /etc/init.d/crond restart</code></pre>
    <p class="muted">Edytuj jako <strong>admin</strong>. NagÅ‚Ã³wek Å›rodowiska na gÃ³rze pliku:</p>
<pre><code>SHELL=/bin/bash
PATH=/sbin:/bin:/usr/sbin:/usr/bin:/usr/local/sbin:/usr/local/bin
TZ=Europe/Warsaw
MAILTO=""</code></pre>

    <h2>1) SkÅ‚adnia jednego wpisu</h2>
<pre><code>MIN   HOUR   DOM   MON   DOW    polecenie
0-59  0-23   1-31  1-12  0-7    (0 lub 7 = niedziela)</code></pre>

    <div class="note">
      <p><strong>DOM vs DOW:</strong> w BusyBox crond (QNAP) jeÅ›li <em>oba</em> pola sÄ… zawÄ™Å¼one (rÃ³Å¼ne od <code>*</code>),
         zadanie wykona siÄ™, gdy speÅ‚niony jest <strong>ktÃ³rykolwiek</strong> z warunkÃ³w (logiczne <strong>OR</strong>), a nie AND.</p>
    </div>

    <h2>2) NajwaÅ¼niejsze: jak dziaÅ‚a <code>*</code> (gwiazdka)</h2>
    <ul>
      <li><strong>Znaczenie podstawowe:</strong> â€<em>dowolna wartoÅ›Ä‡</em> w tym poluâ€. Nie ogranicza harmonogramu.</li>
      <li><strong>Kiedy jest sama:</strong> <code>*</code> w MIN oznacza â€kaÅ¼da minutaâ€, w HOUR â€kaÅ¼da godzinaâ€ itd.</li>
      <li><strong>Ze â€skokiemâ€ (<code>*/n</code>):</strong> â€co <em>n</em> jednostek <u>od zera</u>â€.
        <br>PrzykÅ‚ad: <code>*/15</code> w MIN â†’ minuty <code>0,15,30,45</code>. <code>*/2</code> w HOUR â†’ godziny <code>0,2,4,...,22</code>.</li>
      <li><strong>Ze â€skokiemâ€ od przesuniÄ™cia:</strong> uÅ¼yj zakresu z krokiem: <code>5-59/5</code> w MIN â†’
        minuty <code>5,10,15,...,55</code> (czyli â€co 5 minut, ale zaczynaj od 5â€).</li>
      <li><strong>Listy i zakresy:</strong> gwiazdki moÅ¼esz Å‚Ä…czyÄ‡ z listami i zakresami w innych polach (patrz niÅ¼ej).</li>
    </ul>

    <h2>3) Operatory czasu</h2>
    <table class="table">
      <thead><tr><th>Operator</th><th>PrzykÅ‚ad</th><th>Znaczenie</th></tr></thead>
      <tbody>
        <tr><td><code>*</code></td><td><code>* * * * *</code></td><td>kaÅ¼da minuta kaÅ¼dej godziny â€” â€ciÄ…gleâ€</td></tr>
        <tr><td><code>,</code></td><td><code>0,30 * * * *</code></td><td>o peÅ‚nej i w pÃ³Å‚</td></tr>
        <tr><td><code>-</code></td><td><code>9-17 * * * 1-5</code></td><td>od 9 do 17 w dni 1â€“5 (ponâ€“pt)</td></tr>
        <tr><td><code>/</code></td><td><code>*/10 * * * *</code></td><td>co 10 minut (0,10,20,30,40,50)</td></tr>
        <tr><td><code>zakres/step</code></td><td><code>5-55/10 * * * *</code></td><td>5,15,25,35,45,55</td></tr>
      </tbody>
    </table>
    <p class="muted">Nazwy <em>mon, tue, jan</em> itp. â€” <strong>nie</strong> uÅ¼ywaj na QNAP (BusyBox). Zawsze liczby.</p>

    <h2>4) PrzykÅ‚ady z tÅ‚umaczeniem â€na polskiâ€</h2>
    <div class="ex-grid">
      <div class="card">
        <h3>A. Codziennie o <strong>14:30</strong> (czyli â€2:30 pmâ€)</h3>
<pre><code>30 14 * * * polecenie</code></pre>
        <p><span class="ok">Czytamy:</span> â€<em>minuta 30</em>, <em>godzina 14</em>, dowolny dzieÅ„ miesiÄ…ca, dowolny miesiÄ…c, dowolny dzieÅ„ tygodniaâ€.</p>
      </div>
      <div class="card">
        <h3>B. Co <strong>15 minut</strong></h3>
<pre><code>*/15 * * * * polecenie</code></pre>
        <p><span class="ok">Czytamy:</span> â€kaÅ¼da godzina, <em>minuty 0/15/30/45</em>â€. Gwiazdka z <code>/15</code> startuje od <strong>0</strong>.</p>
      </div>
      <div class="card">
        <h3>C. Co <strong>5 minut, ale od 5</strong> (5,10,15,â€¦55)</h3>
<pre><code>5-59/5 * * * * polecenie</code></pre>
        <p>UÅ¼yliÅ›my zakresu z krokiem â€” to â€przesuniÄ™taâ€ gwiazdka.</p>
      </div>
      <div class="card">
        <h3>D. Wtorki i piÄ…tki o 06:30</h3>
<pre><code>30 6 * * 2,5 polecenie</code></pre>
        <p><code>DOW 2,5</code> â†’ wtorek (2) i piÄ…tek (5).</p>
      </div>
      <div class="card">
        <h3>E. Dni robocze 08:00â€“18:00 co 30 min</h3>
<pre><code>*/30 8-18 * * 1-5 polecenie</code></pre>
        <p>Ponâ€“pt (1â€“5), kaÅ¼da godzina 8â€“18, co 30 minut.</p>
      </div>
      <div class="card">
        <h3>F. 1. dzieÅ„ miesiÄ…ca o 01:00</h3>
<pre><code>0 1 1 * * polecenie</code></pre>
        <p><code>DOM=1</code> â€” bez znaczenia, ktÃ³ry to dzieÅ„ tygodnia.</p>
      </div>
      <div class="card">
        <h3>G. Co 2 godziny o xx:30</h3>
<pre><code>30 */2 * * * polecenie</code></pre>
        <p>Godziny 0,2,4,â€¦,22 â€” zawsze o minucie 30.</p>
      </div>
      <div class="card">
        <h3>H. KaÅ¼dÄ… sobotÄ™ o 23:45</h3>
<pre><code>45 23 * * 6 polecenie</code></pre>
        <p><code>DOW 6</code> â†’ sobota.</p>
      </div>
      <div class="card">
        <h3>I. Dwa konkretne czasy dziennie</h3>
<pre><code>0 7,19 * * * polecenie</code></pre>
        <p>O 07:00 i 19:00.</p>
      </div>
      <div class="card">
        <h3>J. KaÅ¼dy 10. dzieÅ„ miesiÄ…ca o 00:05</h3>
<pre><code>5 0 10 * * polecenie</code></pre>
      </div>
    </div>

    <h2>5) TÅ‚umaczenie czasÃ³w â€ludzkichâ€ â†’ cron</h2>
    <table class="table">
      <thead><tr><th>Opis</th><th>Harmonogram</th></tr></thead>
      <tbody>
        <tr><td>â€Codziennie o 2:30 pmâ€</td><td><code>30 14 * * * polecenie</code></td></tr>
        <tr><td>â€W kaÅ¼dy wtorek 06:30â€</td><td><code>30 6 * * 2 polecenie</code></td></tr>
        <tr><td>â€Co 15 minutâ€</td><td><code>*/15 * * * * polecenie</code></td></tr>
        <tr><td>â€Co godzinÄ™ o xx:07â€</td><td><code>7 * * * * polecenie</code></td></tr>
        <tr><td>â€W dni robocze o 08:00â€</td><td><code>0 8 * * 1-5 polecenie</code></td></tr>
        <tr><td>â€Pierwszy dzieÅ„ miesiÄ…ca 01:00â€</td><td><code>0 1 1 * * polecenie</code></td></tr>
      </tbody>
    </table>

    <h2>6) Tipy i puÅ‚apki</h2>
    <ul>
      <li><strong>Gwiazdka nie â€respektujeâ€ przesuniÄ™cia</strong> â€” <code>*/n</code> zawsze liczy od 0. JeÅ›li chcesz start od 5, stosuj <code>5-59/5</code>.</li>
      <li><strong>DOM vs DOW = OR</strong> (BusyBox). JeÅ›li ustawisz jednoczeÅ›nie <code>DOM</code> i <code>DOW</code>, zadanie uruchomi siÄ™ gdy speÅ‚niony bÄ™dzie ktÃ³rekolwiek z nich.</li>
      <li><strong>Brak rozszerzeÅ„</strong>: zapomnij o <em>L</em>, <em>W</em>, <em>H</em> â€” nie dziaÅ‚a w BusyBox crond.</li>
      <li><strong>Strefa czasu</strong>: dodaj <code>TZ=Europe/Warsaw</code> na gÃ³rze pliku, aby uniknÄ…Ä‡ rozjazdÃ³w.</li>
      <li><strong>Åšrodowisko</strong>: polecenia w cronie majÄ… krÃ³tszy <code>PATH</code>. UÅ¼ywaj peÅ‚nych Å›cieÅ¼ek i loguj wyjÅ›cie: 
        <code>&gt;&gt; /Å›cieÅ¼ka/do/logu 2&gt;&amp;1</code>.</li>
      <li><strong>Blokowanie rÃ³wnolegÅ‚ych startÃ³w bez flock</strong>: zrÃ³b to w wrapperze (atomowe <code>mkdir /tmp/lock</code> + <code>trap</code>).</li>
    </ul>

    <h2>7) PrzykÅ‚ad peÅ‚nej linijki dla wrappera</h2>
<pre><code>30 14 * * * /share/Public/python/work/cron/ceny_07.sh >> /share/Public/python/work/logs/ceny_07_cron.log 2>&1</code></pre>

    <hr />
    <p class="muted">Wersja 2.0 â€¢ Ta strona uÅ¼ywa motywu â€Metroâ€.</p>
  </section>
</main>
<script src="assets/js/metro.js"></script>
</body>
</html>
